export enum UnicodeSimpleCategory {
  Unknown,
  Letter,
  DecimalNumber,
  Number,
  Separator,
}

// list of [(range_begin << 5) + range_type]
// deno-fmt-ignore
const unicodeSimpleCategoryRanges = new Uint32Array([
    0,       1028,    1056,    1538,    1856,    2081,    2912,      3105,    3936,    5124,    5152,    5441,
    5472,    5699,    5760,    5793,    5824,    5923,    5953,      5984,    6019,    6112,    6145,    6880,
    6913,    7904,    7937,    22592,   22721,   23104,   23553,     23712,   23937,   23968,   24001,   24032,
    28161,   28320,   28353,   28416,   28481,   28608,   28641,     28672,   28865,   28896,   28929,   29024,
    29057,   29088,   29121,   29760,   29793,   32448,   32481,     36928,   37185,   42496,   42529,   43744,
    43809,   43840,   44033,   45344,   47617,   48480,   48609,     48736,   50177,   51552,   52226,   52544,
    52673,   52736,   52769,   55936,   55969,   56000,   56481,     56544,   56769,   56834,   57153,   57248,
    57313,   57344,   57857,   57888,   57921,   58880,   59809,     62656,   63009,   63040,   63490,   63809,
    64864,   65153,   65216,   65345,   65376,   65537,   66240,     66369,   66400,   66689,   66720,   66817,
    66848,   67585,   68384,   68609,   68960,   69121,   69888,     69921,   70112,   70657,   72000,   73857,
    75584,   75681,   75712,   76289,   76320,   76545,   76864,     76994,   77312,   77345,   77856,   77985,
    78240,   78305,   78368,   78433,   79136,   79169,   79392,     79425,   79456,   79553,   79680,   79777,
    79808,   80321,   80352,   80769,   80832,   80865,   80960,     81090,   81409,   81472,   81539,   81728,
    81793,   81824,   82081,   82272,   82401,   82464,   82529,     83232,   83265,   83488,   83521,   83584,
    83617,   83680,   83713,   83776,   84769,   84896,   84929,     84960,   85186,   85504,   85569,   85664,
    86177,   86464,   86497,   86592,   86625,   87328,   87361,     87584,   87617,   87680,   87713,   87872,
    87969,   88000,   88577,   88608,   89089,   89152,   89282,     89600,   89889,   89920,   90273,   90528,
    90593,   90656,   90721,   91424,   91457,   91680,   91713,     91776,   91809,   91968,   92065,   92096,
    93057,   93120,   93153,   93248,   93378,   93696,   93729,     93763,   93952,   94305,   94336,   94369,
    94560,   94657,   94752,   94785,   94912,   95009,   95072,     95105,   95136,   95169,   95232,   95329,
    95392,   95489,   95584,   95681,   96064,   96769,   96800,     97474,   97795,   97888,   98465,   98720,
    98753,   98848,   98881,   99616,   99649,   100160,  100257,    100288,  101121,  101216,  101281,  101312,
    101377,  101440,  101570,  101888,  102147,  102368,  102401,    102432,  102561,  102816,  102849,  102944,
    102977,  103712,  103745,  104064,  104097,  104256,  104353,    104384,  105377,  105440,  105473,  105536,
    105666,  105984,  106017,  106080,  106625,  106912,  106945,    107040,  107073,  108384,  108449,  108480,
    108993,  109024,  109185,  109280,  109315,  109537,  109632,    109762,  110083,  110368,  110401,  110592,
    110753,  111328,  111425,  112192,  112225,  112512,  112545,    112576,  112641,  112864,  113858,  114176,
    114721,  116256,  116289,  116352,  116737,  116960,  117250,    117568,  118817,  118880,  118913,  118944,
    118977,  119136,  119169,  119936,  119969,  120000,  120033,    120352,  120385,  120448,  120737,  120768,
    120833,  120992,  121025,  121056,  121346,  121664,  121729,    121856,  122881,  122912,  123906,  124227,
    124544,  124929,  125184,  125217,  126368,  127233,  127392,    131073,  132448,  133089,  133122,  133440,
    133633,  133824,  133953,  134080,  134177,  134208,  134305,    134368,  134593,  134688,  134817,  135232,
    135617,  135648,  135682,  136000,  136193,  137408,  137441,    137472,  137633,  137664,  137729,  139104,
    139137,  149792,  149825,  149952,  150017,  150240,  150273,    150304,  150337,  150464,  150529,  151840,
    151873,  152000,  152065,  153120,  153153,  153280,  153345,    153568,  153601,  153632,  153665,  153792,
    153857,  154336,  154369,  156192,  156225,  156352,  156417,    158560,  159011,  159648,  159745,  160256,
    160769,  163520,  163585,  163776,  163873,  183712,  183777,    184324,  184353,  185184,  185345,  187744,
    187843,  187937,  188192,  188417,  188992,  189409,  190016,    190465,  191040,  191489,  191904,  191937,
    192032,  192513,  194176,  195297,  195328,  195457,  195488,    195586,  195904,  196099,  196416,  197122,
    197440,  197633,  200480,  200705,  200864,  200929,  202016,    202049,  202080,  202241,  204480,  204801,
    205792,  207042,  207361,  208320,  208385,  208544,  208897,    210304,  210433,  211264,  211458,  211779,
    211808,  212993,  213728,  214017,  215712,  217090,  217408,    217602,  217920,  218337,  218368,  221345,
    222848,  223393,  223648,  223746,  224064,  225377,  226336,    226753,  226818,  227137,  228544,  229377,
    230528,  231426,  231744,  231841,  231938,  232257,  233408,    233473,  233760,  233985,  235360,  235425,
    235520,  236833,  236960,  236993,  237184,  237217,  237280,    237377,  237408,  237569,  243712,  245761,
    254656,  254721,  254912,  254977,  256192,  256257,  256448,    256513,  256768,  256801,  256832,  256865,
    256896,  256929,  256960,  256993,  257984,  258049,  259744,    259777,  260000,  260033,  260064,  260161,
    260256,  260289,  260512,  260609,  260736,  260801,  260992,    261121,  261536,  261697,  261792,  261825,
    262048,  262148,  262496,  263428,  263488,  263652,  263680,    265188,  265216,  265731,  265761,  265792,
    265859,  266048,  266209,  266243,  266560,  266753,  267168,    270401,  270432,  270561,  270592,  270657,
    270976,  271009,  271040,  271137,  271296,  271489,  271520,    271553,  271584,  271617,  271648,  271681,
    271808,  271841,  272192,  272257,  272384,  272545,  272704,    272833,  272864,  272899,  274529,  274595,
    274752,  297987,  299904,  302403,  303104,  323267,  324224,    360449,  367776,  367969,  368096,  368193,
    368256,  368547,  368576,  368641,  369856,  369889,  369920,    370081,  370112,  370177,  371968,  372193,
    372224,  372737,  373472,  373761,  373984,  374017,  374240,    374273,  374496,  374529,  374752,  374785,
    375008,  375041,  375264,  375297,  375520,  375553,  375776,    378337,  378368,  393220,  393248,  393377,
    393443,  393472,  394275,  394560,  394785,  394944,  395011,    395105,  395168,  395297,  398048,  398241,
    398336,  398369,  401248,  401281,  401408,  401569,  402944,    402977,  405984,  406083,  406208,  406529,
    407552,  409089,  409600,  410627,  410944,  411907,  412160,    412195,  412672,  413699,  414016,  415267,
    415744,  425985,  636928,  638977,  1348000, 1350145, 1351616,   1351681, 1360288, 1360385, 1360898, 1361217,
    1361280, 1361921, 1363424, 1363937, 1364928, 1364993, 1367235,   1367552, 1368801, 1369088, 1369153, 1372448,
    1372513, 1374560, 1374721, 1374784, 1374817, 1374848, 1374881,   1375040, 1375809, 1376320, 1376353, 1376448,
    1376481, 1376608, 1376641, 1377376, 1377795, 1377984, 1378305,   1379968, 1380417, 1382016, 1382914, 1383232,
    1384001, 1384192, 1384289, 1384320, 1384353, 1384416, 1384450,   1384769, 1385664, 1385985, 1386720, 1387521,
    1388448, 1388673, 1390176, 1391073, 1391106, 1391424, 1391617,   1391776, 1391809, 1392130, 1392449, 1392608,
    1392641, 1393952, 1394689, 1394784, 1394817, 1395072, 1395202,   1395520, 1395713, 1396448, 1396545, 1396576,
    1396673, 1398272, 1398305, 1398336, 1398433, 1398496, 1398561,   1398720, 1398785, 1398816, 1398849, 1398880,
    1399649, 1399744, 1399809, 1400160, 1400385, 1400480, 1400865,   1401056, 1401121, 1401312, 1401377, 1401568,
    1401857, 1402080, 1402113, 1402336, 1402369, 1403744, 1403777,   1404224, 1404417, 1408096, 1408514, 1408832,
    1409025, 1766528, 1766913, 1767648, 1767777, 1769344, 2039809,   2051520, 2051585, 2054976, 2056193, 2056416,
    2056801, 2056960, 2057121, 2057152, 2057185, 2057504, 2057537,   2057952, 2057985, 2058144, 2058177, 2058208,
    2058241, 2058304, 2058337, 2058400, 2058433, 2061888, 2062945,   2074560, 2075137, 2077184, 2077249, 2078976,
    2080257, 2080640, 2084353, 2084512, 2084545, 2088864, 2089474,   2089792, 2090017, 2090848, 2091041, 2091872,
    2092225, 2095072, 2095169, 2095360, 2095425, 2095616, 2095681,   2095872, 2095937, 2096032, 2097153, 2097536,
    2097569, 2098400, 2098433, 2099040, 2099073, 2099136, 2099169,   2099648, 2099713, 2100160, 2101249, 2105184,
    2105571, 2107008, 2107395, 2109216, 2109763, 2109824, 2117633,   2118560, 2118657, 2120224, 2120739, 2121600,
    2121729, 2122755, 2122880, 2123169, 2123811, 2123841, 2124099,   2124128, 2124289, 2125504, 2125825, 2126784,
    2126849, 2128000, 2128129, 2128384, 2128419, 2128576, 2129921,   2134976, 2135042, 2135360, 2135553, 2136704,
    2136833, 2137984, 2138113, 2139392, 2139649, 2141312, 2141697,   2142048, 2142081, 2142560, 2142593, 2142816,
    2142849, 2142912, 2142945, 2143296, 2143329, 2143808, 2143841,   2144064, 2144097, 2144160, 2146305, 2156256,
    2156545, 2157248, 2157569, 2157824, 2158593, 2158784, 2158817,   2160160, 2160193, 2160480, 2162689, 2162880,
    2162945, 2162976, 2163009, 2164416, 2164449, 2164512, 2164609,   2164640, 2164705, 2165440, 2165507, 2165761,
    2166496, 2166563, 2166785, 2167776, 2168035, 2168320, 2169857,   2170464, 2170497, 2170560, 2170723, 2170881,
    2171587, 2171776, 2171905, 2172736, 2174977, 2176768, 2176899,   2176961, 2177027, 2177536, 2177603, 2179073,
    2179104, 2179585, 2179712, 2179745, 2179840, 2179873, 2180800,   2181123, 2181408, 2182145, 2183075, 2183136,
    2183169, 2184099, 2184192, 2185217, 2185472, 2185505, 2186400,   2186595, 2186752, 2187265, 2188992, 2189313,
    2190016, 2190083, 2190337, 2190944, 2191107, 2191361, 2191936,   2192675, 2192896, 2195457, 2197792, 2199553,
    2201184, 2201601, 2203232, 2203459, 2203649, 2204800, 2205186,   2205504, 2214915, 2215904, 2215937, 2217280,
    2217473, 2217536, 2220033, 2220963, 2221281, 2221312, 2221569,   2222272, 2222627, 2222752, 2223617, 2224192,
    2225665, 2226339, 2226560, 2227201, 2227936, 2228321, 2230016,   2230851, 2231490, 2231808, 2231841, 2231904,
    2231969, 2232000, 2232417, 2233856, 2234881, 2235680, 2235906,   2236224, 2236513, 2237664, 2238146, 2238464,
    2238593, 2238624, 2238689, 2238720, 2238977, 2240096, 2240193,   2240224, 2240609, 2242144, 2242593, 2242720,
    2243074, 2243393, 2243424, 2243457, 2243488, 2243619, 2244256,   2244609, 2245184, 2245217, 2246016, 2246625,
    2246688, 2248705, 2248928, 2248961, 2248992, 2249025, 2249152,   2249185, 2249664, 2249697, 2250016, 2250241,
    2251744, 2252290, 2252608, 2252961, 2253216, 2253281, 2253344,   2253409, 2254112, 2254145, 2254368, 2254401,
    2254464, 2254497, 2254656, 2254753, 2254784, 2255361, 2255392,   2255777, 2255936, 2260993, 2262688, 2263265,
    2263392, 2263554, 2263872, 2264033, 2264128, 2265089, 2266624,   2267265, 2267328, 2267361, 2267392, 2267650,
    2267968, 2273281, 2274784, 2276097, 2276224, 2277377, 2278912,   2279553, 2279584, 2279938, 2280256, 2281473,
    2282848, 2283265, 2283296, 2283522, 2283840, 2285569, 2286432,   2287106, 2287427, 2287488, 2287617, 2287840,
    2293761, 2295168, 2298881, 2300930, 2301251, 2301536, 2301921,   2302176, 2302241, 2302272, 2302337, 2302592,
    2302625, 2302688, 2302721, 2303488, 2303969, 2304000, 2304033,   2304064, 2304514, 2304832, 2307073, 2307328,
    2307393, 2308640, 2309153, 2309184, 2309217, 2309248, 2310145,   2310176, 2310497, 2311776, 2312001, 2312032,
    2312705, 2312736, 2313089, 2314560, 2315169, 2315200, 2315777,   2318112, 2326529, 2326816, 2326849, 2328032,
    2328577, 2328608, 2329090, 2329411, 2330016, 2330177, 2331136,   2334721, 2334944, 2334977, 2335040, 2335073,
    2336288, 2336961, 2336992, 2337282, 2337600, 2337793, 2337984,   2338017, 2338080, 2338113, 2339136, 2339585,
    2339616, 2339842, 2340160, 2350081, 2350688, 2351169, 2351200,   2351233, 2351648, 2351681, 2352768, 2353666,
    2353984, 2356737, 2356768, 2357251, 2357920, 2359297, 2388800,   2392067, 2395616, 2396161, 2402432, 2486785,
    2489888, 2490369, 2524672, 2525217, 2525408, 2654209, 2672864,   2949121, 2967328, 2967553, 2968544, 2968578,
    2968896, 2969089, 2971616, 2971650, 2971968, 2972161, 2973120,   2973697, 2975232, 2975745, 2975872, 2976258,
    2976576, 2976611, 2976832, 2976865, 2977536, 2977697, 2978304,   3000321, 3002371, 3003104, 3006465, 3008864,
    3009025, 3009056, 3011169, 3011584, 3013633, 3013696, 3013729,   3013760, 3014657, 3211008, 3211265, 3250880,
    3252225, 3252512, 3538433, 3538560, 3538593, 3538816, 3538849,   3538912, 3538945, 3548256, 3548737, 3548768,
    3549697, 3549792, 3549857, 3549888, 3550337, 3550464, 3550721,   3563392, 3637249, 3640672, 3640833, 3641248,
    3641345, 3641632, 3641857, 3642176, 3823619, 3824256, 3824643,   3825280, 3828739, 3829536, 3833857, 3836576,
    3836609, 3838880, 3838913, 3838976, 3839041, 3839072, 3839137,   3839200, 3839265, 3839392, 3839425, 3839808,
    3839841, 3839872, 3839905, 3840128, 3840161, 3842240, 3842273,   3842400, 3842465, 3842720, 3842753, 3842976,
    3843009, 3843904, 3843937, 3844064, 3844097, 3844256, 3844289,   3844320, 3844417, 3844640, 3844673, 3855552,
    3855617, 3856416, 3856449, 3857248, 3857281, 3858272, 3858305,   3859104, 3859137, 3860128, 3860161, 3860960,
    3860993, 3861984, 3862017, 3862816, 3862849, 3863840, 3863873,   3864672, 3864705, 3864960, 3865026, 3866624,
    3923969, 3924960, 3925153, 3925344, 3933697, 3935680, 3940353,   3941792, 3942113, 3942336, 3942402, 3942720,
    3942849, 3942880, 3953153, 3954112, 3954689, 3956096, 3956226,   3956544, 3971585, 3972480, 3972610, 3972928,
    3996673, 3996896, 3996929, 3997056, 3997089, 3997152, 3997185,   3997664, 3997697, 4004000, 4004067, 4004352,
    4005889, 4008064, 4008289, 4008320, 4008450, 4008768, 4034083,   4035968, 4036003, 4036096, 4036131, 4036256,
    4038691, 4040128, 4040163, 4040640, 4046849, 4046976, 4047009,   4047872, 4047905, 4047968, 4048001, 4048032,
    4048097, 4048128, 4048161, 4048480, 4048513, 4048640, 4048673,   4048704, 4048737, 4048768, 4048961, 4048992,
    4049121, 4049152, 4049185, 4049216, 4049249, 4049280, 4049313,   4049408, 4049441, 4049504, 4049537, 4049568,
    4049633, 4049664, 4049697, 4049728, 4049761, 4049792, 4049825,   4049856, 4049889, 4049920, 4049953, 4050016,
    4050049, 4050080, 4050145, 4050272, 4050305, 4050528, 4050561,   4050688, 4050721, 4050848, 4050881, 4050912,
    4050945, 4051264, 4051297, 4051840, 4052001, 4052096, 4052129,   4052288, 4052321, 4052864, 4071427, 4071840,
    4161026, 4161344, 4194305, 5561344, 5562369, 5695296, 5695489,   5702592, 5702657, 5887040, 5887489, 6126624,
    6225921, 6243264, 6291457, 6449504, 6449665, 6583808, 4294967295
]);

// deno-fmt-ignore
const unicodeSimpleCategoryJumpPos = new Uint16Array([
    1,    9,    27,   27,   27,   27,   36,   44,   55,   55,   57,   63,   68,   75,   86,   91,   102,  114,  119,
    130,  158,  180,  202,  225,  250,  271,  292,  312,  324,  332,  357,  365,  368,  383,  397,  397,  397,  407,
    423,  431,  436,  437,  437,  437,  437,  440,  448,  458,  467,  472,  480,  487,  494,  498,  503,  509,  516,
    524,  538,  538,  540,  540,  540,  558,  578,  592,  595,  622,  625,  625,  625,  625,  625,  626,  629,  629,
    629,  629,  629,  630,  631,  631,  631,  631,  631,  631,  631,  631,  632,  632,  640,  650,  667,  669,  669,
    669,  670,  682,  689,  692,  699,  706,  709,  709,  710,  710,  710,  710,  710,  710,  710,  710,  710,  710,
    710,  710,  710,  710,  710,  710,  710,  710,  710,  710,  710,  710,  710,  710,  710,  710,  710,  710,  710,
    710,  710,  710,  710,  710,  710,  710,  710,  710,  710,  710,  710,  710,  710,  710,  710,  710,  710,  710,
    710,  710,  710,  710,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,
    712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,
    712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,
    712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,
    712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,
    712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,
    712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,
    712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,
    712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,  712,
    712,  712,  712,  712,  712,  712,  712,  716,  716,  716,  724,  728,  731,  741,  752,  763,  769,  781,  793,
    810,  825,  829,  829,  829,  829,  829,  829,  829,  829,  829,  829,  829,  829,  829,  829,  829,  829,  829,
    829,  829,  829,  829,  829,  829,  829,  829,  829,  829,  829,  829,  829,  829,  829,  829,  829,  829,  829,
    829,  829,  829,  829,  829,  829,  829,  829,  829,  829,  829,  829,  829,  829,  829,  829,  829,  829,  829,
    829,  829,  829,  829,  829,  829,  829,  829,  829,  829,  829,  829,  829,  829,  829,  829,  829,  829,  829,
    829,  829,  829,  829,  829,  829,  829,  829,  829,  829,  829,  829,  829,  829,  834,  834,  834,  834,  834,
    834,  834,  834,  834,  834,  834,  834,  834,  834,  834,  834,  834,  834,  834,  834,  834,  834,  834,  834,
    834,  834,  834,  834,  834,  834,  834,  834,  834,  834,  834,  834,  834,  834,  834,  834,  834,  834,  834,
    834,  834,  834,  834,  834,  834,  834,  834,  834,  834,  834,  834,  834,  834,  834,  834,  834,  834,  834,
    834,  834,  834,  834,  835,  835,  835,  837,  839,  857,  859,  859,  859,  861,  866,  869,  870,  877,  887,
    899,  900,  904,  906,  907,  913,  923,  931,  931,  939,  945,  959,  959,  959,  965,  971,  987,  996,  1001,
    1008, 1021, 1030, 1038, 1042, 1044, 1049, 1052, 1052, 1055, 1059, 1067, 1073, 1082, 1088, 1100, 1112, 1118, 1131,
    1149, 1150, 1158, 1165, 1166, 1170, 1176, 1182, 1188, 1189, 1190, 1195, 1210, 1219, 1227, 1232, 1232, 1233, 1242,
    1244, 1258, 1263, 1263, 1265, 1273, 1278, 1278, 1278, 1278, 1278, 1278, 1278, 1278, 1280, 1282, 1282, 1283, 1283,
    1283, 1283, 1283, 1283, 1283, 1283, 1283, 1283, 1283, 1283, 1283, 1283, 1283, 1283, 1283, 1283, 1283, 1283, 1283,
    1286, 1286, 1286, 1286, 1286, 1286, 1286, 1286, 1286, 1289, 1289, 1289, 1289, 1289, 1289, 1289, 1289, 1289, 1289,
    1289, 1289, 1289, 1289, 1289, 1289, 1289, 1289, 1289, 1289, 1289, 1289, 1289, 1289, 1289, 1289, 1289, 1289, 1289,
    1289, 1289, 1290, 1290, 1290, 1290, 1290, 1291, 1291, 1291, 1291, 1291, 1291, 1291, 1291, 1291, 1291, 1291, 1291,
    1291, 1291, 1291, 1291, 1291, 1291, 1291, 1291, 1291, 1291, 1291, 1291, 1291, 1291, 1291, 1291, 1291, 1291, 1291,
    1291, 1291, 1291, 1291, 1291, 1291, 1291, 1291, 1291, 1291, 1291, 1291, 1291, 1291, 1291, 1291, 1291, 1291, 1291,
    1291, 1291, 1291, 1291, 1291, 1291, 1291, 1291, 1291, 1291, 1291, 1291, 1291, 1291, 1291, 1291, 1291, 1292, 1292,
    1292, 1292, 1292, 1298, 1304, 1314, 1315, 1315, 1315, 1315, 1315, 1317, 1319, 1322, 1329, 1329, 1329, 1329, 1329,
    1329, 1329, 1329, 1329, 1329, 1329, 1329, 1329, 1329, 1329, 1329, 1329, 1329, 1329, 1329, 1329, 1329, 1329, 1329,
    1329, 1329, 1329, 1329, 1329, 1329, 1329, 1329, 1329, 1329, 1329, 1329, 1329, 1329, 1329, 1329, 1329, 1329, 1329,
    1329, 1329, 1329, 1329, 1329, 1331, 1331, 1331, 1331, 1331, 1331, 1331, 1331, 1331, 1331, 1333, 1334, 1334, 1334,
    1334, 1334, 1334, 1334, 1334, 1334, 1334, 1334, 1334, 1334, 1334, 1334, 1334, 1334, 1334, 1334, 1334, 1334, 1334,
    1334, 1334, 1334, 1334, 1334, 1334, 1334, 1334, 1334, 1334, 1334, 1334, 1334, 1334, 1334, 1334, 1334, 1334, 1334,
    1334, 1334, 1334, 1334, 1334, 1334, 1334, 1334, 1334, 1334, 1334, 1334, 1334, 1334, 1334, 1334, 1334, 1334, 1334,
    1334, 1334, 1334, 1334, 1334, 1334, 1334, 1334, 1334, 1341, 1341, 1341, 1351, 1351, 1351, 1352, 1352, 1352, 1352,
    1352, 1352, 1352, 1352, 1352, 1352, 1352, 1352, 1352, 1352, 1352, 1352, 1352, 1352, 1353, 1357, 1360, 1360, 1360,
    1360, 1360, 1360, 1360, 1360, 1360, 1360, 1360, 1360, 1360, 1360, 1360, 1360, 1360, 1360, 1360, 1360, 1360, 1360,
    1360, 1360, 1360, 1360, 1360, 1360, 1360, 1360, 1360, 1360, 1360, 1360, 1360, 1360, 1360, 1360, 1360, 1360, 1360,
    1360, 1360, 1360, 1364, 1366, 1367, 1369, 1385, 1403, 1403, 1403, 1411, 1419, 1428, 1428, 1428, 1428, 1428, 1428,
    1428, 1428, 1428, 1428, 1428, 1428, 1428, 1428, 1429, 1432, 1432, 1434, 1435, 1442, 1442, 1442, 1448, 1448, 1448,
    1448, 1452, 1452, 1452, 1452, 1452, 1452, 1461, 1461, 1465, 1470, 1470, 1470, 1470, 1470, 1470, 1471, 1476, 1480,
    1481, 1537, 1546, 1546, 1546, 1546, 1547, 1548, 1548, 1548, 1548, 1548, 1548, 1548, 1548, 1548, 1548, 1548, 1548,
    1548, 1548, 1548, 1548, 1548, 1548, 1548, 1548, 1548, 1550, 1550, 1550, 1550, 1550, 1550, 1550, 1550, 1551, 1563,
    1566, 1566, 1566, 1566, 1566, 1566, 1566, 1566, 1566, 1566, 1566, 1566, 1566, 1566
]);

const unicodeSimpleCategoryTable =
  "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00" +
  "\x00\x00\x00\x00\x04\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02\x02\x02\x02\x02\x02\x02\x02" +
  "\x02\x02\x00\x00\x00\x00\x00\x00\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01" +
  "\x01\x01\x01\x01\x01\x01\x01\x00\x00\x00\x00\x00\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01" +
  "\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x00\x00\x00\x00\x00";

const TABLE_SIZE = 1280;

// deno-fmt-ignore
const toLowerTable = new Int16Array([
    0,     1,    2,    3,    4,     5,    6,    7,    8,    9,    10,   11,   12,   13,   14,   15,   16,   17,   18,
    19,    20,   21,   22,   23,    24,   25,   26,   27,   28,   29,   30,   31,   32,   33,   34,   35,   36,   37,
    38,    39,   40,   41,   42,    43,   44,   45,   46,   47,   48,   49,   50,   51,   52,   53,   54,   55,   56,
    57,    58,   59,   60,   61,    62,   63,   64,   97,   98,   99,   100,  101,  102,  103,  104,  105,  106,  107,
    108,   109,  110,  111,  112,   113,  114,  115,  116,  117,  118,  119,  120,  121,  122,  91,   92,   93,   94,
    95,    96,   97,   98,   99,    100,  101,  102,  103,  104,  105,  106,  107,  108,  109,  110,  111,  112,  113,
    114,   115,  116,  117,  118,   119,  120,  121,  122,  123,  124,  125,  126,  127,  128,  129,  130,  131,  132,
    133,   134,  135,  136,  137,   138,  139,  140,  141,  142,  143,  144,  145,  146,  147,  148,  149,  150,  151,
    152,   153,  154,  155,  156,   157,  158,  159,  160,  161,  162,  163,  164,  165,  166,  167,  168,  169,  170,
    171,   172,  173,  174,  175,   176,  177,  178,  179,  180,  181,  182,  183,  184,  185,  186,  187,  188,  189,
    190,   191,  224,  225,  226,   227,  228,  229,  230,  231,  232,  233,  234,  235,  236,  237,  238,  239,  240,
    241,   242,  243,  244,  245,   246,  215,  248,  249,  250,  251,  252,  253,  254,  223,  224,  225,  226,  227,
    228,   229,  230,  231,  232,   233,  234,  235,  236,  237,  238,  239,  240,  241,  242,  243,  244,  245,  246,
    247,   248,  249,  250,  251,   252,  253,  254,  255,  257,  257,  259,  259,  261,  261,  263,  263,  265,  265,
    267,   267,  269,  269,  271,   271,  273,  273,  275,  275,  277,  277,  279,  279,  281,  281,  283,  283,  285,
    285,   287,  287,  289,  289,   291,  291,  293,  293,  295,  295,  297,  297,  299,  299,  301,  301,  303,  303,
    105,   305,  307,  307,  309,   309,  311,  311,  312,  314,  314,  316,  316,  318,  318,  320,  320,  322,  322,
    324,   324,  326,  326,  328,   328,  329,  331,  331,  333,  333,  335,  335,  337,  337,  339,  339,  341,  341,
    343,   343,  345,  345,  347,   347,  349,  349,  351,  351,  353,  353,  355,  355,  357,  357,  359,  359,  361,
    361,   363,  363,  365,  365,   367,  367,  369,  369,  371,  371,  373,  373,  375,  375,  255,  378,  378,  380,
    380,   382,  382,  383,  384,   595,  387,  387,  389,  389,  596,  392,  392,  598,  599,  396,  396,  397,  477,
    601,   603,  402,  402,  608,   611,  405,  617,  616,  409,  409,  410,  411,  623,  626,  414,  629,  417,  417,
    419,   419,  421,  421,  640,   424,  424,  643,  426,  427,  429,  429,  648,  432,  432,  650,  651,  436,  436,
    438,   438,  658,  441,  441,   442,  443,  445,  445,  446,  447,  448,  449,  450,  451,  454,  454,  454,  457,
    457,   457,  460,  460,  460,   462,  462,  464,  464,  466,  466,  468,  468,  470,  470,  472,  472,  474,  474,
    476,   476,  477,  479,  479,   481,  481,  483,  483,  485,  485,  487,  487,  489,  489,  491,  491,  493,  493,
    495,   495,  496,  499,  499,   499,  501,  501,  405,  447,  505,  505,  507,  507,  509,  509,  511,  511,  513,
    513,   515,  515,  517,  517,   519,  519,  521,  521,  523,  523,  525,  525,  527,  527,  529,  529,  531,  531,
    533,   533,  535,  535,  537,   537,  539,  539,  541,  541,  543,  543,  414,  545,  547,  547,  549,  549,  551,
    551,   553,  553,  555,  555,   557,  557,  559,  559,  561,  561,  563,  563,  564,  565,  566,  567,  568,  569,
    11365, 572,  572,  410,  11366, 575,  576,  578,  578,  384,  649,  652,  583,  583,  585,  585,  587,  587,  589,
    589,   591,  591,  592,  593,   594,  595,  596,  597,  598,  599,  600,  601,  602,  603,  604,  605,  606,  607,
    608,   609,  610,  611,  612,   613,  614,  615,  616,  617,  618,  619,  620,  621,  622,  623,  624,  625,  626,
    627,   628,  629,  630,  631,   632,  633,  634,  635,  636,  637,  638,  639,  640,  641,  642,  643,  644,  645,
    646,   647,  648,  649,  650,   651,  652,  653,  654,  655,  656,  657,  658,  659,  660,  661,  662,  663,  664,
    665,   666,  667,  668,  669,   670,  671,  672,  673,  674,  675,  676,  677,  678,  679,  680,  681,  682,  683,
    684,   685,  686,  687,  688,   689,  690,  691,  692,  693,  694,  695,  696,  697,  698,  699,  700,  701,  702,
    703,   704,  705,  706,  707,   708,  709,  710,  711,  712,  713,  714,  715,  716,  717,  718,  719,  720,  721,
    722,   723,  724,  725,  726,   727,  728,  729,  730,  731,  732,  733,  734,  735,  736,  737,  738,  739,  740,
    741,   742,  743,  744,  745,   746,  747,  748,  749,  750,  751,  752,  753,  754,  755,  756,  757,  758,  759,
    760,   761,  762,  763,  764,   765,  766,  767,  768,  769,  770,  771,  772,  773,  774,  775,  776,  777,  778,
    779,   780,  781,  782,  783,   784,  785,  786,  787,  788,  789,  790,  791,  792,  793,  794,  795,  796,  797,
    798,   799,  800,  801,  802,   803,  804,  805,  806,  807,  808,  809,  810,  811,  812,  813,  814,  815,  816,
    817,   818,  819,  820,  821,   822,  823,  824,  825,  826,  827,  828,  829,  830,  831,  832,  833,  834,  835,
    836,   837,  838,  839,  840,   841,  842,  843,  844,  845,  846,  847,  848,  849,  850,  851,  852,  853,  854,
    855,   856,  857,  858,  859,   860,  861,  862,  863,  864,  865,  866,  867,  868,  869,  870,  871,  872,  873,
    874,   875,  876,  877,  878,   879,  881,  881,  883,  883,  884,  885,  887,  887,  888,  889,  890,  891,  892,
    893,   894,  1011, 896,  897,   898,  899,  900,  901,  940,  903,  941,  942,  943,  907,  972,  909,  973,  974,
    912,   945,  946,  947,  948,   949,  950,  951,  952,  953,  954,  955,  956,  957,  958,  959,  960,  961,  930,
    963,   964,  965,  966,  967,   968,  969,  970,  971,  940,  941,  942,  943,  944,  945,  946,  947,  948,  949,
    950,   951,  952,  953,  954,   955,  956,  957,  958,  959,  960,  961,  962,  963,  964,  965,  966,  967,  968,
    969,   970,  971,  972,  973,   974,  983,  976,  977,  978,  979,  980,  981,  982,  983,  985,  985,  987,  987,
    989,   989,  991,  991,  993,   993,  995,  995,  997,  997,  999,  999,  1001, 1001, 1003, 1003, 1005, 1005, 1007,
    1007,  1008, 1009, 1010, 1011,  952,  1013, 1014, 1016, 1016, 1010, 1019, 1019, 1020, 891,  892,  893,  1104, 1105,
    1106,  1107, 1108, 1109, 1110,  1111, 1112, 1113, 1114, 1115, 1116, 1117, 1118, 1119, 1072, 1073, 1074, 1075, 1076,
    1077,  1078, 1079, 1080, 1081,  1082, 1083, 1084, 1085, 1086, 1087, 1088, 1089, 1090, 1091, 1092, 1093, 1094, 1095,
    1096,  1097, 1098, 1099, 1100,  1101, 1102, 1103, 1072, 1073, 1074, 1075, 1076, 1077, 1078, 1079, 1080, 1081, 1082,
    1083,  1084, 1085, 1086, 1087,  1088, 1089, 1090, 1091, 1092, 1093, 1094, 1095, 1096, 1097, 1098, 1099, 1100, 1101,
    1102,  1103, 1104, 1105, 1106,  1107, 1108, 1109, 1110, 1111, 1112, 1113, 1114, 1115, 1116, 1117, 1118, 1119, 1121,
    1121,  1123, 1123, 1125, 1125,  1127, 1127, 1129, 1129, 1131, 1131, 1133, 1133, 1135, 1135, 1137, 1137, 1139, 1139,
    1141,  1141, 1143, 1143, 1145,  1145, 1147, 1147, 1149, 1149, 1151, 1151, 1153, 1153, 1154, 1155, 1156, 1157, 1158,
    1159,  1160, 1161, 1163, 1163,  1165, 1165, 1167, 1167, 1169, 1169, 1171, 1171, 1173, 1173, 1175, 1175, 1177, 1177,
    1179,  1179, 1181, 1181, 1183,  1183, 1185, 1185, 1187, 1187, 1189, 1189, 1191, 1191, 1193, 1193, 1195, 1195, 1197,
    1197,  1199, 1199, 1201, 1201,  1203, 1203, 1205, 1205, 1207, 1207, 1209, 1209, 1211, 1211, 1213, 1213, 1215, 1215,
    1231,  1218, 1218, 1220, 1220,  1222, 1222, 1224, 1224, 1226, 1226, 1228, 1228, 1230, 1230, 1231, 1233, 1233, 1235,
    1235,  1237, 1237, 1239, 1239,  1241, 1241, 1243, 1243, 1245, 1245, 1247, 1247, 1249, 1249, 1251, 1251, 1253, 1253,
    1255,  1255, 1257, 1257, 1259,  1259, 1261, 1261, 1263, 1263, 1265, 1265, 1267, 1267, 1269, 1269, 1271, 1271, 1273,
    1273,  1275, 1275, 1277, 1277,  1279, 1279,
]);

// deno-fmt-ignore
const toLowerRanges = new Int32Array([
    1280,       2097153, 1328,    1328,    1329,   -1378,   1367,   -1368,   4256,   -11521,  4294,    4294,    4295,
    11559,      4296,    -4297,   4301,    11565,  4302,    -4303,  5024,    -43889, 5104,    -5113,   5110,    -5111,
    7312,       -4305,   7355,    -7356,   7357,   -4350,   7360,   -7361,   7680,   2097153, 7830,    -7831,   7838,
    223,        7839,    2097153, 7936,    -7937,  7944,    -7937,  7952,    -7953,  7960,    -7953,   7966,    -7967,
    7976,       -7969,   7984,    -7985,   7992,   -7985,   8000,   -8001,   8008,   -8001,   8014,    -8015,   8025,
    8017,       8026,    8026,    8027,    8019,   8028,    8028,   8029,    8021,   8030,    8030,    8031,    8023,
    8032,       -8033,   8040,    -8033,   8048,   -8049,   8072,   -8065,   8080,   -8081,   8088,    -8081,   8096,
    -8097,      8104,    -8097,   8112,    -8113,  8120,    -8113,  8122,    -8049,  8124,    8115,    8125,    -8126,
    8136,       -8051,   8140,    8131,    8141,   -8142,   8152,   -8145,   8154,   -8055,   8156,    -8157,   8168,
    -8161,      8170,    -8059,   8172,    8165,   8173,    -8174,  8184,    -8057,  8186,    -8061,   8188,    8179,
    8189,       -8190,   8486,    969,     8487,   -8488,   8490,   107,     8491,   229,     8492,    -8493,   8498,
    8526,       8499,    -8500,   8544,    -8561,  8560,    -8561,  8579,    8580,   8581,    -8582,   9398,    -9425,
    9424,       -9425,   11264,   -11313,  11312,  -11313,  11360,  11361,   11362,  619,     11363,   7549,    11364,
    637,        11365,   -11366,  11367,   11368,  11369,   11370,  11371,   11372,  11373,   593,     11374,   625,
    11375,      592,     11376,   594,     11377,  2097153, 11380,  11380,   11381,  11382,   11383,   -11384,  11390,
    -576,       11392,   2097153, 11492,   -11493, 11499,   11500,  11501,   11502,  11503,   -11504,  11506,   11507,
    11508,      -11509,  42560,   2097153, 42606,  -42607,  42624,  2097153, 42652,  -42653,  42786,   2097153, 42800,
    -42801,     42802,   2097153, 42864,   -42865, 42873,   42874,  42875,   42876,  42877,   7545,    42878,   2097153,
    42888,      -42889,  42891,   42892,   42893,  613,     42894,  -42895,  42896,  2097153, 42900,   -42901,  42902,
    2097153,    42922,   614,     42923,   604,    42924,   609,    42925,   620,    42926,   618,     42927,   42927,
    42928,      670,     42929,   647,     42930,  669,     42931,  43859,   42932,  2097153, 42948,   42900,   42949,
    642,        42950,   7566,    42951,   42952,  42953,   42954,  42955,   -42956, 42960,   42961,   42962,   -42963,
    42966,      2097153, 42970,   -42971,  42997,  42998,   42999,  -43000,  65313,  -65346,  65339,   -65340,  66560,
    -66601,     66600,   -66601,  66736,   -66777, 66772,   -66773, 66928,   -66968, 66939,   66939,   66940,   -66980,
    66955,      66955,   66956,   -66996,  66963,  66963,   66964,  -67004,  66966,  -66967,  68736,   -68801,  68787,
    -68788,     71840,   -71873,  71872,   -71873, 93760,   -93793, 93792,   -93793, 125184,  -125219, 125218,  -125219,
    2147483647, 0
]);

export function getUnicodeSimpleCategory(code: number): UnicodeSimpleCategory {
  if (code < 128) return unicodeSimpleCategoryTable[code].codePointAt(0)!;
  const jumpPosIndex = code <= 0x20000 ? code >> 7 : (0x20000 >> 7) - (0x20000 >> 16) + (code >> 16);
  let it = unicodeSimpleCategoryJumpPos[jumpPosIndex];
  code = (code << 5) + 30;
  while (unicodeSimpleCategoryRanges[it] <= code) ++it;
  return (unicodeSimpleCategoryRanges[it - 1] & 31);
}

export function binarySearchRanges(ranges: Int32Array, code: number) {
  if (code > 0x10ffff) {
    return 0;
  }

  const codeInt = code;
  let l = 0;
  let r = ranges.length;
  while (l < r) {
    const m = ((l + r + 2) >> 2) << 1;
    if (ranges[m] <= codeInt) {
      l = m;
    } else {
      r = m - 2;
    }
  }

  const t = ranges[l + 1];
  if (t < 0) {
    return code - ranges[l] + (~t);
  }
  if (t <= 0x10ffff) {
    return t;
  }
  switch (t - 0x200000) {
    case 0:
      return (code & -2);
    case 1:
      return (code | 1);
    case 2:
      return ((code - 1) | 1);
    default:
      console.error(code, l, r, t);
      return 0;
  }
}

export function unicodeToLower(code: number) {
  if (code < TABLE_SIZE) {
    return toLowerTable[code];
  } else {
    return binarySearchRanges(toLowerRanges, code);
  }
}
